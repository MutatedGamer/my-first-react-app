{"ast":null,"code":"import _defineProperty from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/lukebord/react/sm-buddy/src/components/AddPlay/index.js\";\nimport React, { Component } from 'react';\nimport { AuthUserContext, withAuthorization } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport { Container, Row, Col } from 'react-bootstrap';\nimport * as ROUTES from '../../constants/routes';\nimport { Link, withRouter } from 'react-router-dom';\nimport { compose } from 'recompose';\nimport { firestore } from 'firebase';\nimport PlayName from './Steps/PlayName';\nimport PlayDescription from './Steps/PlayDescription';\nimport PlayActor from './Steps/PlayActor';\nvar INITIAL_STATE = {\n  name: '',\n  description: '',\n  error: '',\n  step: 3,\n  actors: [{\n    name: \"\",\n    characters: [\"\"],\n    notes: \"\",\n    unavailibilities: []\n  }]\n};\n\nvar AddPlayPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AddPlayPage, _Component);\n\n  function AddPlayPage(props) {\n    var _this;\n\n    _classCallCheck(this, AddPlayPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddPlayPage).call(this, props));\n\n    _this.nextStep = function () {\n      var step = _this.state.step;\n\n      _this.setState({\n        step: step + 1\n      });\n    };\n\n    _this.prevStep = function () {\n      var step = _this.state.step;\n\n      _this.setState({\n        step: step - 1\n      });\n    };\n\n    _this.onSubmit = function (event) {\n      event.preventDefault();\n\n      _this.props.firebase.db.collection(\"shows\").add({\n        name: _this.state.name,\n        description: _this.state.description,\n        created: firestore.FieldValue.serverTimestamp()\n      }).then(function () {\n        _this.setState(_objectSpread({}, INITIAL_STATE));\n      }).then(function () {\n        _this.props.history.push(ROUTES.ADMIN);\n      }).catch(function (error) {\n        _this.setState({\n          error: error\n        });\n      });\n    };\n\n    _this.onChange = function (e) {\n      if (_this.state.step == 3) {\n        var actors = _toConsumableArray(_this.state.actors);\n\n        if (e.target.dataset.type == \"outer\") {\n          actors[e.target.dataset.actorid][e.target.dataset.attr] = e.target.value;\n\n          _this.setState(function (prevState) {\n            return {\n              actors: actors\n            };\n          });\n        } else if (e.target.dataset.type == \"inner\") {\n          console.log('here');\n\n          if (e.target.dataset.timeattr) {\n            var timeattr = e.target.dataset.timeattr;\n            var value = e.target.value;\n\n            if (timeattr != \"day\") {\n              value = parseInt(e.target.value);\n            }\n\n            actors[e.target.dataset.actorid][e.target.dataset.attr][e.target.dataset.attrid][timeattr] = value;\n          } else {\n            actors[e.target.dataset.actorid][e.target.dataset.attr][e.target.dataset.attrid] = e.target.value;\n          }\n\n          _this.setState(function (prevState) {\n            return {\n              actors: actors\n            };\n          });\n        }\n      } else {\n        _this.setState(_defineProperty({}, e.target.name, e.target.value));\n      }\n    };\n\n    _this.updateCharacter = function (e) {\n      var collection = e.target.dataset.collection;\n\n      var values = _toConsumableArray(_this.state[collection]);\n\n      var elementID = e.target.dataset.elementid;\n      var charID = e.target.dataset.charrid;\n      values[elementID][\"characters\"][charID] = e.target.value;\n\n      _this.setState(function (prevState) {\n        return {\n          values: values\n        };\n      });\n    };\n\n    _this.updateUnavailibility = function (e) {\n      console.log(\"here\");\n      var collection = e.target.dataset.collection;\n\n      var values = _toConsumableArray(_this.state[collection]);\n\n      var elementID = e.target.dataset.elementid;\n      var timeID = e.target.dataset.timeid;\n      var value = e.target.value;\n      var timeattr = e.target.dataset.timeattr;\n\n      if (timeattr != \"day\") {\n        value = parseInt(value);\n      }\n\n      values[elementID][\"unavailibilities\"][timeID][timeattr] = value;\n      console.log(values);\n\n      _this.setState(function (prevState) {\n        return {\n          values: values\n        };\n      });\n    };\n\n    _this.addActor = function (e) {\n      e.preventDefault();\n\n      _this.setState(function (prevState) {\n        return {\n          actors: [].concat(_toConsumableArray(prevState.actors), [{\n            name: \"\",\n            characters: [\"\"],\n            notes: \"\",\n            unavailibilities: []\n          }])\n        };\n      });\n    };\n\n    _this.addCharacter = function (type, i, e) {\n      var values = _toConsumableArray(_this.state[type]);\n\n      values[i][\"characters\"] = [].concat(_toConsumableArray(_this.state[type][i][\"characters\"]), [\"\"]);\n\n      _this.setState(function (prevState) {\n        return {\n          values: values\n        };\n      });\n    };\n\n    _this.removeCharacter = function (type, i, charIndx, e) {\n      var values = _toConsumableArray(_this.state[type]);\n\n      var characters = values[i][\"characters\"];\n\n      if (characters.length == 1) {\n        return;\n      } else {\n        var newCharacters = characters.slice(0, charIndx).concat(characters.slice(charIndx + 1, characters.length));\n        values[i][\"characters\"] = newCharacters;\n\n        _this.setState(function (prevState) {\n          return {\n            values: values\n          };\n        });\n      }\n    };\n\n    _this.addUnavailibility = function (i, e) {\n      var actors = _toConsumableArray(_this.state.actors);\n\n      actors[i][\"unavailibilities\"] = [].concat(_toConsumableArray(_this.state.actors[i][\"unavailibilities\"]), [{\n        day: \"sunday\",\n        start: 32400,\n        end: 32400\n      }]);\n      console.log(actors[i]);\n\n      _this.setState(function (prevState) {\n        return {\n          actors: actors\n        };\n      });\n    };\n\n    _this.removeUnavailbility = function (i, dataIndx, e) {\n      var actors = _toConsumableArray(_this.state.actors);\n\n      var data = actors[i][\"unavailibilities\"];\n      var newData = data.slice(0, dataIndx).concat(data.slice(dataIndx + 1, data.length));\n      actors[i][\"unavailibilities\"] = newData;\n\n      _this.setState(function (prevState) {\n        return {\n          actors: actors\n        };\n      });\n    };\n\n    _this.state = _objectSpread({}, INITIAL_STATE);\n    return _this;\n  }\n\n  _createClass(AddPlayPage, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, this.getStep())), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, this.error && React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, this.error.message))));\n    }\n  }, {\n    key: \"getStep\",\n    value: function getStep() {\n      var _this$state = this.state,\n          name = _this$state.name,\n          description = _this$state.description,\n          error = _this$state.error,\n          actors = _this$state.actors,\n          step = _this$state.step;\n      var values = {\n        name: name,\n        description: description,\n        actors: actors\n      };\n\n      switch (step) {\n        case 1:\n          return React.createElement(PlayName, {\n            nextStep: this.nextStep,\n            onChange: this.onChange,\n            values: values,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 200\n            },\n            __self: this\n          });\n\n        case 2:\n          return React.createElement(PlayDescription, {\n            nextStep: this.nextStep,\n            prevStep: this.prevStep,\n            onChange: this.onChange,\n            values: values,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 206\n            },\n            __self: this\n          });\n\n        case 3:\n          return React.createElement(PlayActor, {\n            nextStep: this.nextStep,\n            prevStep: this.prevStep,\n            onChange: this.onChange,\n            addActor: this.addActor,\n            addCharacter: this.addCharacter,\n            removeCharacter: this.removeCharacter,\n            updateCharacter: this.updateCharacter,\n            addUnavailibility: this.addUnavailibility,\n            removeUnavailbility: this.removeUnavailbility,\n            updateUnavailibility: this.updateUnavailibility,\n            values: values,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 213\n            },\n            __self: this\n          });\n        //TODO: submit page\n\n        default:\n          return null;\n      }\n    }\n  }]);\n\n  return AddPlayPage;\n}(Component);\n\nvar condition = function condition(authUser) {\n  return !!authUser;\n};\n\nexport default withFirebase(withRouter(withAuthorization(condition)(AddPlayPage)));","map":{"version":3,"sources":["/home/lukebord/react/sm-buddy/src/components/AddPlay/index.js"],"names":["React","Component","AuthUserContext","withAuthorization","withFirebase","Container","Row","Col","ROUTES","Link","withRouter","compose","firestore","PlayName","PlayDescription","PlayActor","INITIAL_STATE","name","description","error","step","actors","characters","notes","unavailibilities","AddPlayPage","props","nextStep","state","setState","prevStep","onSubmit","event","preventDefault","firebase","db","collection","add","created","FieldValue","serverTimestamp","then","history","push","ADMIN","catch","onChange","e","target","dataset","type","actorid","attr","value","prevState","console","log","timeattr","parseInt","attrid","updateCharacter","values","elementID","elementid","charID","charrid","updateUnavailibility","timeID","timeid","addActor","addCharacter","i","removeCharacter","charIndx","length","newCharacters","slice","concat","addUnavailibility","day","start","end","removeUnavailbility","dataIndx","data","newData","getStep","message","condition","authUser"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { AuthUserContext, withAuthorization } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport { Container, Row, Col} from 'react-bootstrap';\nimport * as ROUTES from '../../constants/routes';\nimport { Link, withRouter } from 'react-router-dom';\nimport { compose } from 'recompose';\nimport { firestore } from 'firebase';\nimport PlayName from './Steps/PlayName';\nimport PlayDescription from './Steps/PlayDescription';\nimport PlayActor from './Steps/PlayActor';\n\nconst INITIAL_STATE = {\n    name: '',\n    description: '',\n    error: '',\n    step: 3,\n    actors: [{name:\"\", characters:[\"\"], notes:\"\", unavailibilities: []}],\n}\n\nclass AddPlayPage extends Component {\n  constructor(props) {\n      super(props);\n\n      this.state = { ...INITIAL_STATE };\n  }\n\n  nextStep = () => {\n      const { step } = this.state;\n      this.setState({\n          step : step + 1\n      });\n  }\n\n  prevStep = () => {\n      const { step } = this.state;\n      this.setState({\n          step : step - 1\n      });\n  }\n\n  onSubmit = event => {\n    event.preventDefault();\n      this.props.firebase.db.collection(\"shows\").add({\n          name: this.state.name,\n          description : this.state.description,\n          created: firestore.FieldValue.serverTimestamp(),\n      })\n      .then(() => {\n          this.setState({ ...INITIAL_STATE });\n      })\n      .then(() => {\n          this.props.history.push(ROUTES.ADMIN);\n      })\n      .catch(error => {\n          this.setState({ error });\n      });\n  };\n\n  onChange = (e) => {\n    if (this.state.step == 3) {\n      let actors = [...this.state.actors];\n      if (e.target.dataset.type == \"outer\") {\n        actors[e.target.dataset.actorid][e.target.dataset.attr] = e.target.value;\n        this.setState((prevState) => ({\n          actors\n        }));\n      } else if (e.target.dataset.type == \"inner\") {\n        console.log('here');\n        if (e.target.dataset.timeattr) {\n          let timeattr = e.target.dataset.timeattr;\n          let value = e.target.value\n          if (timeattr != \"day\") {\n            value = parseInt(e.target.value);\n          }\n          actors[e.target.dataset.actorid][e.target.dataset.attr][e.target.dataset.attrid][timeattr] = value;\n        } else {\n          actors[e.target.dataset.actorid][e.target.dataset.attr][e.target.dataset.attrid] = e.target.value;\n        }\n        this.setState((prevState) => ({\n          actors\n        }));\n      }\n    } else {\n      this.setState({ [e.target.name]: e.target.value })\n    }\n  }\n\n  updateCharacter = (e) => {\n    let collection = e.target.dataset.collection;\n    let values = [...this.state[collection]];\n    let elementID = e.target.dataset.elementid;\n    let charID = e.target.dataset.charrid;\n\n    values[elementID][\"characters\"][charID] = e.target.value;\n    this.setState((prevState) => ( {\n      values\n    }));\n  }\n\n  updateUnavailibility = (e) => {\n    console.log(\"here\");\n    let collection = e.target.dataset.collection;\n    let values = [...this.state[collection]];\n    let elementID = e.target.dataset.elementid;\n    let timeID = e.target.dataset.timeid;\n\n    let value = e.target.value;\n    let timeattr  = e.target.dataset.timeattr;\n    if (timeattr != \"day\") {\n      value = parseInt(value);\n    }\n\n    values[elementID][\"unavailibilities\"][timeID][timeattr] = value;\n    console.log(values);\n    this.setState((prevState) => ( {\n      values\n    }));\n  }\n\n\n\n  addActor = (e) => {\n    e.preventDefault();\n    this.setState((prevState) => ({\n      actors: [...prevState.actors, {name:\"\", characters:[\"\"], notes:\"\", unavailibilities: []}],\n    }));\n  }\n\n  addCharacter = (type, i, e) => {\n    let values = [...this.state[type]];\n    values[i][\"characters\"] = [...this.state[type][i][\"characters\"], \"\"];\n    this.setState((prevState) => ({\n      values\n    }));\n  }\n\n  removeCharacter = (type, i, charIndx, e) => {\n    let values = [...this.state[type]];\n    let characters = values[i][\"characters\"];\n    if (characters.length == 1) {\n      return;\n    } else {\n      let newCharacters = characters.slice(0, charIndx).concat(characters.slice(charIndx+1, characters.length));\n      values[i][\"characters\"] = newCharacters;\n      this.setState((prevState) => ({\n        values\n      }));\n    }\n  }\n\n  addUnavailibility = (i, e) => {\n    let actors = [...this.state.actors];\n    actors[i][\"unavailibilities\"] = [...this.state.actors[i][\"unavailibilities\"], {day: \"sunday\", start:32400, end:32400}];\n    console.log(actors[i]);\n    this.setState((prevState) => ({\n      actors\n    }));\n  }\n\n\n\n  removeUnavailbility = (i, dataIndx, e) => {\n    let actors = [...this.state.actors];\n    let data = actors[i][\"unavailibilities\"];\n    let newData = data.slice(0, dataIndx).concat(data.slice(dataIndx+1, data.length));\n    actors[i][\"unavailibilities\"] = newData;\n    this.setState((prevState) => ({\n      actors\n    }));\n  }\n  render() {\n      return (\n          <Container>\n              <Row>\n                  <Col>\n                      {this.getStep()}\n                  </Col>\n              </Row>\n              <Row>\n                  <Col>\n                      {this.error && <p>{this.error.message}</p>}\n                  </Col>\n              </Row>\n          </Container>\n      );\n  }\n\n  getStep() {\n      const {\n          name,\n          description,\n          error,\n          actors,\n          step,\n      } = this.state;\n      const values = { name, description, actors };\n      switch (step) {\n        case 1:\n          return <PlayName\n                  nextStep = {this.nextStep}\n                  onChange = {this.onChange}\n                  values = {values }\n                  />\n        case 2:\n          return <PlayDescription\n                  nextStep = {this.nextStep}\n                  prevStep = {this.prevStep}\n                  onChange = {this.onChange}\n                  values = {values}\n                  />\n        case 3:\n          return <PlayActor\n                  nextStep = {this.nextStep}\n                  prevStep = {this.prevStep}\n                  onChange = {this.onChange}\n                  addActor = {this.addActor}\n                  addCharacter = {this.addCharacter}\n                  removeCharacter = {this.removeCharacter}\n                  updateCharacter = {this.updateCharacter}\n                  addUnavailibility = {this.addUnavailibility}\n                  removeUnavailbility = {this.removeUnavailbility}\n                  updateUnavailibility = {this.updateUnavailibility}\n                  values = {values}\n                  />\n            //TODO: submit page\n        default:\n            return null;\n\n      }\n\n  }\n}\n\nconst condition = authUser => !!authUser;\n\nexport default withFirebase(withRouter(withAuthorization(condition)(AddPlayPage)));\n"]},"metadata":{},"sourceType":"module"}