{"ast":null,"code":"import _defineProperty from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/lukebord/react/sm-buddy/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/lukebord/react/sm-buddy/src/components/AddPlay/index.js\";\nimport React, { Component } from 'react';\nimport { AuthUserContext, withAuthorization, withAuthentication } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport { Container, Row, Col } from 'react-bootstrap';\nimport * as ROUTES from '../../constants/routes';\nimport { Link, withRouter } from 'react-router-dom';\nimport { compose } from 'recompose';\nimport { firestore } from 'firebase';\nimport PlayName from './Steps/PlayName';\nimport PlayActor from './Steps/PlayActor';\nimport PlayScene from './Steps/PlayScene';\nimport ReviewPage from './Steps/Review';\n\nvar AddPlayPage = function AddPlayPage() {\n  return React.createElement(AuthUserContext.Consumer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16\n    },\n    __self: this\n  }, function (authUser) {\n    return React.createElement(AddPlayPageAuth, {\n      authUser: authUser,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 17\n      },\n      __self: this\n    });\n  });\n};\n\nvar AddPlayPageAuth =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AddPlayPageAuth, _Component);\n\n  function AddPlayPageAuth(props) {\n    var _this;\n\n    _classCallCheck(this, AddPlayPageAuth);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddPlayPageAuth).call(this, props));\n\n    _this.nextStep = function () {\n      var step = _this.state.step;\n\n      _this.setState({\n        step: step + 1\n      });\n    };\n\n    _this.prevStep = function () {\n      var step = _this.state.step;\n\n      _this.setState({\n        step: step - 1\n      });\n    };\n\n    _this.onSubmit = function (event) {\n      console.log(\"here\");\n      var characterMap = new Map();\n      var characters = new Set();\n\n      _this.state.actors.forEach(function (actor) {\n        actor.characters.forEach(function (character) {\n          characters.add(character);\n        });\n      });\n\n      characters = Array.from(characters).sort();\n      var db = _this.props.firebase.db;\n      db.collection(\"shows\").add({\n        name: _this.state.name,\n        description: _this.state.description,\n        created: firestore.FieldValue.serverTimestamp(),\n        creator: _this.state.uid\n      }).then(function (showDocRef) {\n        var show = db.collection(\"shows\").doc(showDocRef.id);\n        characters.forEach(function (character, index) {\n          show.collection(\"characters\").add({\n            name: character\n          }).then(function (charDocRef) {\n            characterMap.set(character, charDocRef.id);\n\n            if (characterMap.size == characters.length) {\n              console.log(characterMap);\n              console.log(characterMap.get('c1'));\n\n              _this.state.actors.forEach(function (actor, index) {\n                var actorCharArray = actor.characters.map(function (character) {\n                  var id = characterMap.get(character);\n                  return show.collection(\"characters\").doc(id);\n                });\n                show.collection(\"actors\").add({\n                  name: actor.name,\n                  notes: actor.notes,\n                  characters: actorCharArray\n                }).then(function (actorDocRef) {\n                  actor.unavailibilities.forEach(function (unavailability, index) {\n                    show.collection(\"actors\").doc(actorDocRef.id).collection(\"recurring unavailibilities\").add({\n                      day: unavailability.day,\n                      start: unavailability.start,\n                      end: unavailability.end\n                    });\n                  });\n                });\n              });\n\n              _this.state.scenes.forEach(function (scene, index) {\n                var sceneCharArray = scene.characters.map(function (character) {\n                  var id = characterMap.get(character);\n                  return show.collection(\"characters\").doc(id);\n                });\n\n                _this.props.firebase.db.collection('shows').doc(showDocRef.id).collection(\"scenes\").add({\n                  title: scene.title,\n                  notes: scene.notes,\n                  blocking: parseInt(scene.block),\n                  table: parseInt(scene.table),\n                  characters: sceneCharArray\n                });\n              });\n            }\n          });\n        });\n      }).then(function () {\n        _this.setState(_objectSpread({}, INITIAL_STATE));\n      }).then(function () {\n        _this.props.history.push(ROUTES.ADMIN);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    };\n\n    _this.onChange = function (e) {\n      e.preventDefault();\n      var collection = e.target.dataset.collection;\n\n      if (collection != null) {\n        var values = _toConsumableArray(_this.state[collection]);\n\n        var elementID = e.target.dataset.elementid;\n        var attr = e.target.dataset.attr;\n        values[elementID][attr] = e.target.value;\n\n        _this.setState(function (prevState) {\n          return {\n            values: values\n          };\n        });\n      } else {\n        _this.setState(_defineProperty({}, e.target.name, e.target.value));\n      }\n\n      console.log(_this.state);\n    };\n\n    _this.updateCharacter = function (e) {\n      e.preventDefault();\n      var collection = e.target.dataset.collection;\n\n      var values = _toConsumableArray(_this.state[collection]);\n\n      var elementID = e.target.dataset.elementid;\n      var charID = e.target.dataset.charrid;\n      values[elementID][\"characters\"][charID] = e.target.value;\n\n      _this.setState(function (prevState) {\n        return {\n          values: values\n        };\n      });\n\n      e.stopPropagation();\n    };\n\n    _this.updateUnavailibility = function (e) {\n      e.preventDefault();\n      var collection = e.target.dataset.collection;\n\n      var values = _toConsumableArray(_this.state[collection]);\n\n      var elementID = e.target.dataset.elementid;\n      var timeID = e.target.dataset.timeid;\n      var value = e.target.value;\n      var timeattr = e.target.dataset.timeattr;\n\n      if (timeattr != \"day\") {\n        value = parseInt(value);\n      }\n\n      values[elementID][\"unavailibilities\"][timeID][timeattr] = value;\n      console.log(values);\n\n      _this.setState(function (prevState) {\n        return {\n          values: values\n        };\n      });\n\n      e.stopPropagation();\n    };\n\n    _this.addActor = function (e) {\n      e.preventDefault();\n\n      _this.setState(function (prevState) {\n        return {\n          actors: [].concat(_toConsumableArray(prevState.actors), [{\n            name: \"\",\n            characters: [\"\"],\n            notes: \"\",\n            unavailibilities: []\n          }])\n        };\n      });\n    };\n\n    _this.addScene = function (e) {\n      e.preventDefault();\n\n      _this.setState(function (prevState) {\n        return {\n          scenes: [].concat(_toConsumableArray(prevState.scenes), [{\n            title: \"\",\n            characters: [\"\"],\n            notes: \"\",\n            block: 0,\n            table: 0\n          }])\n        };\n      });\n    };\n\n    _this.addCharacter = function (type, i, e) {\n      e.preventDefault();\n\n      var values = _toConsumableArray(_this.state[type]);\n\n      values[i][\"characters\"] = [].concat(_toConsumableArray(_this.state[type][i][\"characters\"]), [\"\"]);\n\n      _this.setState(function (prevState) {\n        return {\n          values: values\n        };\n      });\n    };\n\n    _this.deleteItem = function (type, i, e) {\n      e.preventDefault();\n\n      var values = _toConsumableArray(_this.state[type]);\n\n      if (values.length == 1) {\n        console.log('here');\n        return;\n      } else {\n        var newValues = values.slice(0, i).concat(values.slice(i + 1, values.length));\n\n        if (type == \"scenes\") {\n          _this.setState(function (prevState) {\n            return {\n              \"scenes\": newValues\n            };\n          });\n        } else if (type == \"actors\") {\n          _this.setState(function (prevState) {\n            return {\n              \"actors\": newValues\n            };\n          });\n        }\n      }\n    };\n\n    _this.removeCharacter = function (type, i, charIndx, e) {\n      e.preventDefault();\n\n      var values = _toConsumableArray(_this.state[type]);\n\n      var characters = values[i][\"characters\"];\n\n      if (characters.length == 1) {\n        return;\n      } else {\n        var newCharacters = characters.slice(0, charIndx).concat(characters.slice(charIndx + 1, characters.length));\n        values[i][\"characters\"] = newCharacters;\n\n        _this.setState(function (prevState) {\n          return {\n            values: values\n          };\n        });\n      }\n    };\n\n    _this.addUnavailibility = function (i, e) {\n      e.preventDefault();\n\n      var actors = _toConsumableArray(_this.state.actors);\n\n      actors[i][\"unavailibilities\"] = [].concat(_toConsumableArray(_this.state.actors[i][\"unavailibilities\"]), [{\n        day: \"sunday\",\n        start: 32400,\n        end: 32400\n      }]);\n      console.log(actors[i]);\n\n      _this.setState(function (prevState) {\n        return {\n          actors: actors\n        };\n      });\n    };\n\n    _this.removeUnavailbility = function (i, dataIndx, e) {\n      e.preventDefault();\n\n      var actors = _toConsumableArray(_this.state.actors);\n\n      var data = actors[i][\"unavailibilities\"];\n      var newData = data.slice(0, dataIndx).concat(data.slice(dataIndx + 1, data.length));\n      actors[i][\"unavailibilities\"] = newData;\n\n      _this.setState(function (prevState) {\n        return {\n          actors: actors\n        };\n      });\n    };\n\n    var _INITIAL_STATE = {\n      name: '',\n      description: '',\n      error: '',\n      step: 1,\n      actors: [{\n        name: \"\",\n        characters: [\"\"],\n        notes: \"\",\n        unavailibilities: []\n      }],\n      scenes: [{\n        title: \"\",\n        characters: [\"\"],\n        notes: \"\",\n        block: 0,\n        table: 0\n      }],\n      uid: props.authUser.uid\n    };\n    _this.state = _objectSpread({}, _INITIAL_STATE);\n    return _this;\n  }\n\n  _createClass(AddPlayPageAuth, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270\n        },\n        __self: this\n      }, this.getStep())), React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274\n        },\n        __self: this\n      }, React.createElement(Col, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275\n        },\n        __self: this\n      }, this.error && React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276\n        },\n        __self: this\n      }, this.error.message))));\n    }\n  }, {\n    key: \"getStep\",\n    value: function getStep() {\n      var _this$state = this.state,\n          name = _this$state.name,\n          description = _this$state.description,\n          error = _this$state.error,\n          actors = _this$state.actors,\n          step = _this$state.step,\n          scenes = _this$state.scenes;\n      var values = {\n        name: name,\n        description: description,\n        actors: actors,\n        scenes: scenes\n      };\n\n      switch (step) {\n        case 1:\n          return React.createElement(PlayName, {\n            nextStep: this.nextStep,\n            onChange: this.onChange,\n            values: values,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 295\n            },\n            __self: this\n          });\n\n        case 2:\n          return React.createElement(PlayActor, {\n            nextStep: this.nextStep,\n            prevStep: this.prevStep,\n            onChange: this.onChange,\n            addActor: this.addActor,\n            addCharacter: this.addCharacter,\n            removeCharacter: this.removeCharacter,\n            updateCharacter: this.updateCharacter,\n            addUnavailibility: this.addUnavailibility,\n            removeUnavailbility: this.removeUnavailbility,\n            updateUnavailibility: this.updateUnavailibility,\n            deleteItem: this.deleteItem,\n            values: values,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 301\n            },\n            __self: this\n          });\n\n        case 3:\n          return React.createElement(PlayScene, {\n            nextStep: this.nextStep,\n            prevStep: this.prevStep,\n            onChange: this.onChange,\n            addScene: this.addScene,\n            addCharacter: this.addCharacter,\n            removeCharacter: this.removeCharacter,\n            updateCharacter: this.updateCharacter,\n            addUnavailibility: this.addUnavailibility,\n            removeUnavailbility: this.removeUnavailbility,\n            updateUnavailibility: this.updateUnavailibility,\n            deleteItem: this.deleteItem,\n            values: values,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 316\n            },\n            __self: this\n          });\n\n        case 4:\n          return React.createElement(ReviewPage, {\n            nextStep: this.nextStep,\n            prevStep: this.prevStep,\n            values: values,\n            onChange: this.onChange,\n            onSubmit: this.onSubmit,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 331\n            },\n            __self: this\n          });\n        //TODO: submit page\n\n        default:\n          return null;\n      }\n    }\n  }]);\n\n  return AddPlayPageAuth;\n}(Component);\n\nvar condition = function condition(authUser) {\n  return !!authUser;\n};\n\nexport default withAuthentication(withFirebase(withRouter(withAuthorization(condition)(AddPlayPage))));","map":{"version":3,"sources":["/home/lukebord/react/sm-buddy/src/components/AddPlay/index.js"],"names":["React","Component","AuthUserContext","withAuthorization","withAuthentication","withFirebase","Container","Row","Col","ROUTES","Link","withRouter","compose","firestore","PlayName","PlayActor","PlayScene","ReviewPage","AddPlayPage","authUser","AddPlayPageAuth","props","nextStep","step","state","setState","prevStep","onSubmit","event","console","log","characterMap","Map","characters","Set","actors","forEach","actor","character","add","Array","from","sort","db","firebase","collection","name","description","created","FieldValue","serverTimestamp","creator","uid","then","showDocRef","show","doc","id","index","charDocRef","set","size","length","get","actorCharArray","map","notes","actorDocRef","unavailibilities","unavailability","day","start","end","scenes","scene","sceneCharArray","title","blocking","parseInt","block","table","INITIAL_STATE","history","push","ADMIN","catch","error","onChange","e","preventDefault","target","dataset","values","elementID","elementid","attr","value","prevState","updateCharacter","charID","charrid","stopPropagation","updateUnavailibility","timeID","timeid","timeattr","addActor","addScene","addCharacter","type","i","deleteItem","newValues","slice","concat","removeCharacter","charIndx","newCharacters","addUnavailibility","removeUnavailbility","dataIndx","data","newData","getStep","message","condition"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { AuthUserContext, withAuthorization, withAuthentication } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport { Container, Row, Col} from 'react-bootstrap';\nimport * as ROUTES from '../../constants/routes';\nimport { Link, withRouter } from 'react-router-dom';\nimport { compose } from 'recompose';\nimport { firestore } from 'firebase';\nimport PlayName from './Steps/PlayName';\nimport PlayActor from './Steps/PlayActor';\nimport PlayScene from './Steps/PlayScene';\nimport ReviewPage from './Steps/Review';\n\n\nconst AddPlayPage = () => (\n  <AuthUserContext.Consumer>\n    {authUser => <AddPlayPageAuth authUser={authUser}/> }\n  </AuthUserContext.Consumer>\n);\n\nclass AddPlayPageAuth extends Component {\n\n  constructor(props) {\n      super(props);\n      const INITIAL_STATE = {\n            name: '',\n            description: '',\n            error: '',\n            step: 1,\n            actors: [{name:\"\", characters:[\"\"], notes:\"\", unavailibilities: []}],\n            scenes: [{title:\"\", characters:[\"\"], notes:\"\", block:0, table:0}],\n            uid: props.authUser.uid,\n        }\n      this.state = { ...INITIAL_STATE };\n  }\n\n  nextStep = () => {\n      const { step } = this.state;\n      this.setState({\n          step : step + 1\n      });\n  }\n\n  prevStep = () => {\n      const { step } = this.state;\n      this.setState({\n          step : step - 1\n      });\n  }\n\n  onSubmit = event => {\n    console.log(\"here\");\n    var characterMap = new Map();\n    let characters = new Set();\n    this.state.actors.forEach((actor) => {\n      actor.characters.forEach((character) => {\n        characters.add(character);\n      })\n    });\n    characters = Array.from(characters).sort();\n\n    let db = this.props.firebase.db;\n\n    db.collection(\"shows\").add({\n        name: this.state.name,\n        description : this.state.description,\n        created: firestore.FieldValue.serverTimestamp(),\n        creator: this.state.uid,\n    })\n    .then((showDocRef) => {\n      let show = db.collection(\"shows\").doc(showDocRef.id);\n      characters.forEach((character, index) => {\n        show.collection(\"characters\").add({\n          name: character,\n        })\n        .then((charDocRef) => {\n          characterMap.set(character, charDocRef.id);\n          if (characterMap.size == characters.length) {\n\n            console.log(characterMap);\n            console.log(characterMap.get('c1'));\n\n            this.state.actors.forEach((actor, index) => {\n              let actorCharArray = actor.characters.map((character) => {\n                  let id = characterMap.get(character);\n                  return show.collection(\"characters\").doc(id);\n              });\n              show.collection(\"actors\").add({\n                name: actor.name,\n                notes: actor.notes,\n                characters: actorCharArray,\n              })\n              .then((actorDocRef) => {\n                actor.unavailibilities.forEach((unavailability, index) => {\n                  show.collection(\"actors\").doc(actorDocRef.id).collection(\"recurring unavailibilities\").add({\n                    day: unavailability.day,\n                    start: unavailability.start,\n                    end: unavailability.end,\n                  });\n                });\n              })\n            });\n            this.state.scenes.forEach((scene, index) => {\n              let sceneCharArray = scene.characters.map((character) => {\n                  let id = characterMap.get(character);\n                  return show.collection(\"characters\").doc(id);\n              });\n              this.props.firebase.db.collection('shows').doc(showDocRef.id).collection(\"scenes\").add({\n                title: scene.title,\n                notes: scene.notes,\n                blocking: parseInt(scene.block),\n                table: parseInt(scene.table),\n                characters: sceneCharArray,\n              });\n            });\n          }\n        });\n      });\n\n    })\n    .then(() => {\n        this.setState({ ...INITIAL_STATE });\n    })\n    .then(() => {\n        this.props.history.push(ROUTES.ADMIN);\n    })\n    .catch(error => {\n        console.log(error);\n    });\n  };\n\n  onChange = (e) => {\n    e.preventDefault();\n    let collection = e.target.dataset.collection;\n    if (collection != null) {\n      let values = [...this.state[collection]];\n      let elementID = e.target.dataset.elementid;\n      let attr = e.target.dataset.attr;\n      values[elementID][attr] = e.target.value;\n      this.setState((prevState) => ({\n       values\n      }));\n    } else {\n      this.setState({ [e.target.name]: e.target.value })\n    }\n    console.log(this.state)\n  }\n\n  updateCharacter = (e) => {\n    e.preventDefault();\n    let collection = e.target.dataset.collection;\n    let values = [...this.state[collection]];\n    let elementID = e.target.dataset.elementid;\n    let charID = e.target.dataset.charrid;\n\n    values[elementID][\"characters\"][charID] = e.target.value;\n    this.setState((prevState) => ( {\n      values\n    }));\n    e.stopPropagation();\n  }\n\n  updateUnavailibility = (e) => {\n    e.preventDefault();\n    let collection = e.target.dataset.collection;\n    let values = [...this.state[collection]];\n    let elementID = e.target.dataset.elementid;\n    let timeID = e.target.dataset.timeid;\n\n    let value = e.target.value;\n    let timeattr  = e.target.dataset.timeattr;\n    if (timeattr != \"day\") {\n      value = parseInt(value);\n    }\n\n    values[elementID][\"unavailibilities\"][timeID][timeattr] = value;\n    console.log(values);\n    this.setState((prevState) => ( {\n      values\n    }));\n    e.stopPropagation();\n  }\n\n\n\n  addActor = (e) => {\n    e.preventDefault();\n    this.setState((prevState) => ({\n      actors: [...prevState.actors, {name:\"\", characters:[\"\"], notes:\"\", unavailibilities: []}],\n    }));\n  }\n\n  addScene = (e) => {\n    e.preventDefault();\n    this.setState((prevState) => ({\n      scenes: [...prevState.scenes, {title:\"\", characters:[\"\"], notes:\"\", block:0, table:0}],\n    }));\n  }\n\n  addCharacter = (type, i, e) => {\n    e.preventDefault();\n    let values = [...this.state[type]];\n    values[i][\"characters\"] = [...this.state[type][i][\"characters\"], \"\"];\n    this.setState((prevState) => ({\n      values\n    }));\n  }\n\n  deleteItem = (type, i, e) => {\n    e.preventDefault();\n    let values = [...this.state[type]];\n    if (values.length == 1) {\n      console.log('here');\n      return;\n    } else {\n      let newValues = values.slice(0, i).concat(values.slice(i + 1, values.length));\n      if (type == \"scenes\") {\n        this.setState((prevState) => ({\n            \"scenes\": newValues\n        }));\n      } else if (type == \"actors\") {\n        this.setState((prevState) => ({\n            \"actors\": newValues\n        }));\n      }\n    }\n  }\n\n  removeCharacter = (type, i, charIndx, e) => {\n    e.preventDefault();\n    let values = [...this.state[type]];\n    let characters = values[i][\"characters\"];\n    if (characters.length == 1) {\n      return;\n    } else {\n      let newCharacters = characters.slice(0, charIndx).concat(characters.slice(charIndx+1, characters.length));\n      values[i][\"characters\"] = newCharacters;\n      this.setState((prevState) => ({\n        values\n      }));\n    }\n  }\n\n  addUnavailibility = (i, e) => {\n    e.preventDefault();\n    let actors = [...this.state.actors];\n    actors[i][\"unavailibilities\"] = [...this.state.actors[i][\"unavailibilities\"], {day: \"sunday\", start:32400, end:32400}];\n    console.log(actors[i]);\n    this.setState((prevState) => ({\n      actors\n    }));\n  }\n\n\n\n  removeUnavailbility = (i, dataIndx, e) => {\n    e.preventDefault();\n    let actors = [...this.state.actors];\n    let data = actors[i][\"unavailibilities\"];\n    let newData = data.slice(0, dataIndx).concat(data.slice(dataIndx+1, data.length));\n    actors[i][\"unavailibilities\"] = newData;\n    this.setState((prevState) => ({\n      actors\n    }));\n  }\n  render() {\n      return (\n          <Container>\n              <Row>\n                  <Col>\n                      {this.getStep()}\n                  </Col>\n              </Row>\n              <Row>\n                  <Col>\n                      {this.error && <p>{this.error.message}</p>}\n                  </Col>\n              </Row>\n          </Container>\n      );\n  }\n\n  getStep() {\n      const {\n          name,\n          description,\n          error,\n          actors,\n          step,\n          scenes,\n      } = this.state;\n      const values = { name, description, actors, scenes };\n      switch (step) {\n        case 1:\n          return <PlayName\n                  nextStep = {this.nextStep}\n                  onChange = {this.onChange}\n                  values = {values }\n                  />\n        case 2:\n          return <PlayActor\n                  nextStep = {this.nextStep}\n                  prevStep = {this.prevStep}\n                  onChange = {this.onChange}\n                  addActor = {this.addActor}\n                  addCharacter = {this.addCharacter}\n                  removeCharacter = {this.removeCharacter}\n                  updateCharacter = {this.updateCharacter}\n                  addUnavailibility = {this.addUnavailibility}\n                  removeUnavailbility = {this.removeUnavailbility}\n                  updateUnavailibility = {this.updateUnavailibility}\n                  deleteItem= {this.deleteItem}\n                  values = {values}\n                  />\n        case 3:\n          return <PlayScene\n                  nextStep = {this.nextStep}\n                  prevStep = {this.prevStep}\n                  onChange = {this.onChange}\n                  addScene= {this.addScene}\n                  addCharacter = {this.addCharacter}\n                  removeCharacter = {this.removeCharacter}\n                  updateCharacter = {this.updateCharacter}\n                  addUnavailibility = {this.addUnavailibility}\n                  removeUnavailbility = {this.removeUnavailbility}\n                  updateUnavailibility = {this.updateUnavailibility}\n                  deleteItem= {this.deleteItem}\n                  values = {values}\n                  />\n          case 4:\n            return <ReviewPage\n              nextStep = {this.nextStep}\n              prevStep = {this.prevStep}\n              values = {values}\n              onChange = {this.onChange}\n              onSubmit = {this.onSubmit}\n              />\n            //TODO: submit page\n        default:\n            return null;\n\n      }\n\n  }\n}\n\nconst condition = authUser => !!authUser;\n\nexport default withAuthentication(withFirebase(withRouter(withAuthorization(condition)(AddPlayPage))));\n"]},"metadata":{},"sourceType":"module"}